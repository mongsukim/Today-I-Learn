## ğŸ“† 2022-04-06 (ìˆ˜) TIL

### ğŸ”¥ ì˜¤ëŠ˜ í•œ ì¼ <br>

```useEffect``` ê°€ ì•„ë‹Œ ```useQuery``` ì»¤ìŠ¤í…€ í›…ìœ¼ë¡œ ë°ì´í„° ë°›ì•„ì˜¤ë„ë¡ ë³€ê²½í•¨


#### ê¸°ì¡´ì— ë°ì´í„° ë°›ì•„ì˜¤ë˜ ë°©ì‹ : useEffect

apiHomepage.tsx (axios í†µì‹ ì½”ë“œ ëª¨ì•„ë‘ëŠ” ê³³)
```js
export const getMeetingDemoList: Function = async (token: string = TOKEN) => {
    console.log("APIí•¨ìˆ˜ /meetingDemo/getMeetingDemoList");
    return await axios.get(APIADDRESS + "/meetingDemo/getMeetingDemoList?accessToken=" + token);
};
```


DemoLists.tsx

```js
... ë¦¬ì•¡íŠ¸ ì½”ë“œ ìƒëµ

    const [ demoList, setDemoList ] = useState<any>(); //ë°›ì•„ì˜¨ ë°ì´í„°ê°’ì„ ë°›ëŠ” ë°°ì—´

    useEffect(()=>{
         apiHomepage.getMeetingDemoList() //ìœ„ì˜ axiosí•¨ìˆ˜ í˜¸ì¶œ
         .then((result) => {
             console.log('getDemoList datadata', result.data.data)
             const keyArr = result.data.data.map((data,index)=>{ //tableì— keyê°’ì„ ìƒì„±í•´ì•¼ í•´ì„œ ê²°ê³¼ì— keyê°’ì„ ì¶”ê°€ëœ ë°°ì—´ KeyArrì„ ìƒì„±í•œë‹¤.
                 return{
                     email: data.meetingApplicantEmail,
                     Institude: data.meetingApplicantInstitude,
                     Interests: data.meetingApplicantInterests,
                     JobTitle: data.meetingApplicantJobTitle,
                     Name: data.meetingApplicantName,
                     PhoneNum: data.meetingApplicantPhoneNum,
                     Questions: data.meetingApplicantQuestions,
                     RegDateTime: data.meetingApplicantRegDateTime,
                     userSeq: data.meetingApplicantSeq,
                     meetingPreferredDateTime: data.meetingPreferredDateTime,
                     // meetingApplicantConsentUsePersonalInfo: data.meetingApplicantConsentUsePersonalInfo,
                     // ê°œì¸ì •ë³´ìˆ˜ì§‘ë™ì˜ëŠ” ë¬´ì¡°ê±´ í•„ìˆ˜ê°’(Y)ì´ë¯€ë¡œ í˜ì´ì§€ í‘œì— í‘œê¸°í•˜ì§€ ì•ŠìŒ
                     meetingApplicantConsentUseMarketing: data.meetingApplicantConsentUseMarketing,
                     key:index
                 }
             })
             console.log('keyArr',keyArr)
             setDemoList(keyArr) // demoListë¥¼ setí•œë‹¤
         }).catch(error =>{
             console.log('ì—ëŸ¬', error)
             }
         )
     }, [setDemoList]);
```

ê¸°ì¡´ì—” ìœ„ì—ì„œ returní•œ ê°’ë“¤ì„ í…Œì´ë¸”ì˜ ```dataSource``` ë¡œ ë„£ì–´ì£¼ì—ˆë‹¤. 
```js
 <Table
            columns={columns}
            rowSelection={rowSelection}
            dataSource={demoList}
            loading={loading}
            onChange={onChange}
            pagination={{pageSize:20}}
        />
```

### ìƒˆë¡œìš´ ë°©ì‹ : useQuery ì»¤ìŠ¤í…€ í›… ì‚¬ìš© 

demoHooks.ts
```js
import {useQuery} from "react-query";
import { DemoList } from "../types";
import {getMeetingDemoList} from "../../../lib/apiHomepage";

export enum DemoKeysEnum {
    DemoList = 'demoList',
}


export const useGetDemoList = ( token: string | undefined) => {
    return useQuery(
        [DemoKeysEnum.DemoList], async () => {
            const res = await getMeetingDemoList(token)
            console.log('ë°ëª¨ë¦¬ìŠ¤íŠ¸', res.data.data)
            return res.data.data as DemoList[]
        }, {
            select: (datas) => datas.map((data,index) =>({...data,key:index})) //ë°›ì•„ì˜¨ ë°ì´í„°ì— keyê°’ì„ ë„£ì–´ì£¼ëŠ” ì½”ë“œ
        }
    )
}

```

DemoList.tsx

```js
import {useAuthStore} from "../../store/authHooks"; //ë¡œê·¸ì¸ ê´€ë ¨ í›… 
import {useGetDemoList} from "../../api/hooks/Demo/demoHooks"; // ë°ëª¨ë¦¬ìŠ¤íŠ¸ ì¡°íšŒí•˜ëŠ” í›… 

const HomepageDemoLists: FC = () => { // HomepageDemoListsë¼ëŠ” ì»´í¬ë„ŒíŠ¸ì´ë‹¤. 
  const user = useAuthStore(state => state.user)
  const {data: demoData} = useGetDemoList(user?.accessToken) // useEffectë¡œ ë¶ˆëŸ¬ì˜¤ë˜ ë°©ì‹ì´ ì´ ì½”ë“œ í•˜ë‚˜ë¡œ í•´ê²°ëœë‹¤ ! 
  const [ demoList, setDemoList ] = useState<any>();

 //ìƒëµ
   return (
        <div className={Styles.page_wrap}>
        <h2 className={Styles.admin_title}>Meeting / Demo List</h2>
        <p className={Styles.admin_txt}>í™ˆí˜ì´ì§€ì—ì„œ ì‹ ì²­ëœ ë¯¸íŒ…/ë°ëª¨ ëª©ë¡ì„ ì¡°íšŒí•œë‹¤.</p>
        <Table
            columns={columns}
            rowSelection={rowSelection}
            dataSource={demoData} // useGetDemoListë¡œ ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ í…Œì´ë¸” ì†ŒìŠ¤ë¡œ í™œìš©í•œë‹¤.
            loading={loading}
            onChange={onChange}
            pagination={{pageSize:20}}
        />
        {/* <Button onClick={publicDelete} type="primary" danger >
          ì„ íƒì‚­ì œ
        </Button>    */}
       
    </div>
    )
```
